# m1

## m1上安装包问题


1. 安装老版本node

- 选择x86环境

```
arch -x86_64 zsh
arch -x86_64 $SHELL
```

## 安装gitbook问题

1. node版本问题

2. m1环境问题

- 报错

```
xcode-select: error: tool 'xcodebuild' requires Xcode, but active developer directory '/Library/Developer/CommandLineTools' is a command line tools instance
```

- 解决方法
[node-gyp issues/569](https://github.com/nodejs/node-gyp/issues/569)

```
xcode-select --install
sudo xcode-select --switch /Library/Developer/CommandLineTools
```

即使这样依然还是会报上面的错误，从下面的错误看出可能是node-gyp的问题，在[node-gyp macOS_Catalina.md](https://github.com/nodejs/node-gyp/blob/master/macOS_Catalina.md)找到解决方法

```
curl -sL https://github.com/nodejs/node-gyp/raw/master/macOS_Catalina_acid_test.sh | bash
```

然后终于能正常工作了，因为一开始nodev17也报错xcode-select，我尝试使用nodev17去安装gitbook，发现依然不行，`gitbook init`之后只有README.md文件，没有SUMMARY.md文件。

不得不说M1虽然很好，但是环境问题真的很烦人，为了装个gitbook花了我差不多两天的时间，原本我在node官网下载的v17的node，安装gitbook报错cb.apply is not a function，这个问题基本属于网上搜到大家统一的问题，解决方案就是安装老版本的node，因此我去安装nvm，但是网上搜的一句话命令有装不上，网络问题，最后迫不得已用brew（因为大家都说不推荐，所以一开始没用）。接着使用nvm安装老版本node的时候又有arm架构问题，得使用`arch -x86_64 zsh`切换到x86才能装，最后就是装了nodev10发现gitbook依然跑不起来，卡在3.2.3那半天，最后报个错，真的是吐血了。
