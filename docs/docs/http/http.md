## https

TCP 三次握手：客户端向服务器发送一个请求，服务器返回接受到客户端请求的回应，客户端再发送请求告诉服务器接受到服务器回应的请求；
四次分手：客户端向服务器发送分手请求，服务器回应客户端接受到客户端的请求；服务器向客户端回应分手请求，客户端发生请求告诉服务器收到了分手回应

### 密钥

- 对称密钥：客户端和服务器需要有相同的密钥才能解密信息
- 非对称密钥：
  - 公钥加密，私钥解密；私钥加密，公钥解密
  - 非对称密钥只能保证单向传输的安全

网络传输安全：
系统内置有证书，是通过官方平台对域名的认证，在服务器中写入（第三方私钥等？）特定的文件，第三方的公钥客户端都有，第三方的公钥对服务器的公钥以及其他信息进行加密。

客户端发送的使用服务器公钥加密的信息传个服务器，中间的代理也有公钥，但是无法解密信息，服务器使用私钥解密信息，向客户端返回结果，此时中间的代理可以通过公钥看到返回结果，但是不能修改。

客户端第一次使用公钥加密自己随机生成的一串密钥，发送给服务器，此时中间代理拥有的公钥无法查看，服务器使用私钥解密客户端的密钥，使用客户端的密钥加密返回结果，此时中间代理也无法查看到返回结果。

### HTTPS 四次握手

- 第一次握手
  - 客户端向服务器发送一个随机数 clientKey
  - 客户端发送 SSL 协议版本
  - 客户端发送 可选的加密算法
  - 客户端发送 可选的压缩算法
- 第二次握手
  - 服务端向客户端发送 随机数 server key
  - 服务端向客户端发送 选择的压缩算法
  - 服务端向客户端发送 选择的加密算法
  - 服务端发送数字证书(包含公钥)
- 第三次握手（前置操作：判断服务端的证书是否合法）
  - 客户端发送第三个随机数 premaster key
  - 使用 3 个 key 来生成会话用的对称密钥。
  - 客户端通知编码变更：接下来会话都会加密。
  - 客户端发送握手结束通知（一条前面所有内容的 hash 值，供服务端校验）
- 第四次握手
  - 服务端接收到加密后的 premaster key, 用私钥解密，用三个 key 计算出会话用的对称密钥
  - 通知编码变更
  - 通知握手结束
  - 发送 hash 值
